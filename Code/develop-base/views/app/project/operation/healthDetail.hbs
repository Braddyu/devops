<style>
    .spanRed{
        /*background: #ff6666;*/
        color: #9e0505;
    }
    .spanGreen{
        /*background: #66cc33;*/
        color:#66cc33;
    }
    .spanGrey{
        /*background: #9d9d9d;*/
        color: #9d9d9d;
    }
    .imgSize{
        width: 8%;
        height: 13%;
    }
    .textSize{
        color: #0a0a0a;
        border:0px;
        background-color:lightgrey;
    /*lightgrey#f7f8f9*/
        width: 100%;
        height: 100%;
        /*readonly："readonly"*/
    }
    .div-text{
        overflow-y:auto;
        width: 100%;
        height: 200px;
    }
    .span{
        background:#05d165;
        /*display: inline-block;*/
        padding:0 8px;
        width: 80%;
        height:30px;
        text-align: center;
        line-height: 30px;
        border-radius: 2px;
        -webkit-border-radius: 2px;
        -moz-border-radius: 2px;

    }
</style>
<link rel="stylesheet" href="{{projcfg.appurl}}/static/request/css/gengzhong-xianqin.css">

<div class="row" >
    <div class="col-sm-10" style="padding: 0px;margin-top: -10px">
        <h4> 应用名称：<span id="app_name"> </span></h4>
    </div>
    <div class="col-sm-2">
        <button type="button" onclick="goBack()"id="dd" class="btn btn-default" data-toggle="tooltip" data-placement="top" data-original-title="返回" style="margin-right:0px">
        <i class="fa fa-undo">返回</i>
    </button></div>
</div>
<div class="row">
    <div class="bor" style="margin-top: -30px;padding: 0px"></div>
    <div class="container"  id="requestList">

    </div>
</div>

<script>
    var searchData = window.location.href.split("=");
    var id = decodeURI(searchData[1]);
//    var id=decodeURI(searchData[2]);


    $.ajax({
        url: '{{projcfg.appurl}}/api/project/operation/healthDetail',
        type: 'post',
        data:{
            id:id,
        },
        success: function (data) {
            console.log(data.data);

            var name=data.data.app_name;
            $('#app_name').text(name);
            // console.log("result666-----",data[0].rows[0].module);
            var json=JSON.parse(data.data.check_content);
            var json_log=JSON.parse(data.data.content_log);


//            alert(json.sql);

            if(json.app==0){
                json.app="应用异常";
                json.img_a="offnormal.png"
            }else if(json.app==1){
                json.app="应用正常";
                json.img_a="normal.png"
            }else{
                alert("app数据未采集");
            }

            if(json.sql==0){
                json.sql="数据库异常";
                json.img_s="offnormal.png"
            }else if(json.sql==1){
                json.sql="数据库正常";
                json.img_s="normal.png"
            }else{
                alert("sql数据未采集");
            }

            if(json.middle==0){
                json.middle="中间件异常";
                json.img_m="offnormal.png"
            }else if(json.middle==1){
                json.middle="中间件正常";
                json.img_m="normal.png"
            }else{
                alert("middle数据未采集");
            }




            var html='';
//            for(var i=0;i<json_log.length;i++){
//                if(json.app==0){
                     html+='<div class="row" style="margin-bottom: 20px;">'+
                            '<div class="col-sm-1" style="position: relative;">'+

                            '</div>'+
                            '<div class="col-sm-10" >'+
                            '<table class="table table-condensed gz-top" style="margin-bottom: 2px;">'+
                            '<tbody>'+
                            '<tr>'+
                            '<td><span class="spanRed">'+json.app+'</span><img src="{{projcfg.appurl}}/static/images/'+json.img_a+'"'+'style="width:3%" class="imgSize"'+'></td>'+
                            ' </tr>'+
//                            '<tr>'+
//                            ' <td>'+"应用日志:"+'</td>'+
//                            ' </tr>'+
//                            '<tr>'+
                            '<td colspan="2"><div class="div-text">' +json_log.app+
                            '</div></td>'+
                            '</tr>'+
                             '<tr>'+
                             ' </tr>'+
                             '<tr>'+
                            ' </tbody>'+
                            ' </table>'+
                            ' </div>' +
                            ' </div>'
//                }
//                if(json.sql==0){
                     html+='<div class="row" style="margin-bottom: 20px;">'+
                            '<div class="col-sm-1" style="position: relative;">'+

                            '</div>'+
                            '<div class="col-sm-10" >'+
                            '<table class="table table-condensed gz-top" style="margin-bottom: 2px;">'+
                            '<tbody>'+
                            '<tr>'+
                            ' <td><span class="spanRed">'+json.sql+'</span><img src="{{projcfg.appurl}}/static/images/'+json.img_s+'"'+'style="width:3%" class="imgSize"'+'></td>'+
                            '</tr>'+
                            '</tr>'+
//                            '<tr>'+
//                            ' <td>'+"数据库日志:"+'</td>'+
//                            '</tr>'+
                            '<tr>'+
                            '<td colspan="2"><div class="div-text">' +json_log.sql+
                            '</div></td>'+
                            '</tr>'+
                            ' </tbody>'+
                            ' </table>'+
                            ' </div>' +
                            ' </div>'
//                }
//                if(json.middle==0){
                    html+='<div class="row" style="margin-bottom: 20px;">'+
                            '<div class="col-sm-1" style="position: relative;">'+

                            '</div>'+
                            '<div class="col-sm-10" >'+
                            '<table class="table table-condensed gz-top" style="margin-bottom: 2px;">'+
                            '<tbody>'+
                            '<tr>'+
                            ' <td><span class="spanRed">'+json.middle+'</span><img src="{{projcfg.appurl}}/static/images/'+json.img_m+'"'+'style="width:3%" class="imgSize"'+'></td>'+
                            '</tr>'+
//                            '<tr>'+
//                            ' <td>'+"中间件日志:"+'</td>'+
//                            '</tr>'+
                            '<tr>'+
                            '<td colspan="2"><div class="div-text">' +json_log.middle+
                            '</div></td>'+
                            '</tr>'+
                            ' </tbody>'+
                            ' </table>'+
                            ' </div>' +
                            ' </div>'
//                }
//            }

//                html+=item;
            $('#requestList').append(html);
        }
    });

    function goBack(){
        window.history.go(-1);
    }


</script>